# TODO

## ✅ Soulbound Token 防止多重投票

### **理念：**

向每位通过链下身份验证（例如，使用西班牙数字证书）的公民发放一个 Soulbound
Token（不可转让的 NFT）。只有拥有该 Token 的钱包才可在 DemocracyChain 智能合约中投票。

### 🎯 **动机**

- 防止同一人使用多个钱包进行多次投票。
- 保持隐私：不在链上存储身份证或个人数据。
- 实现链上流程的完全去中心化，不暴露敏感信息。
- 易于与官方电子身份系统集成（如 FNMT 证书）。
- 使用成熟标准（ERC721），实现简单安全。

### ⚙️ **执行步骤**

✅ **步骤 1 — 开发 Soulbound Token 合约：**

- 创建一个 ERC721，重写 `transfer` 函数禁止转移。
- 实现 `mintSoulbound(address to)` 函数，仅供验证后端调用。

✅ **步骤 2 — 修改 DemocracyChain：**

- 添加对 Soulbound Token 合约的引用（存储地址）。
- 在 `vote()` 函数中添加验证逻辑：

  ```solidity
  require(soulboundToken.balanceOf(msg.sender) > 0, "Not verified citizen");
  ```

✅ **步骤 3 — 开发链下验证后端：**

- 集成链下验证（数字证书或其他身份验证方法）。
- 验证通过后，调用 `mintSoulbound` 向公民钱包发放 Token。

✅ **步骤 4 — 验证后发放 Token：**

- 可选：后端存储身份证哈希，防止重复验证。
- 向公民发送通知，告知其钱包已授权投票。

✅ **步骤 5 — 更新前端：**

- 在 DApp 中加入身份验证流程。
- 显示钱包是否持有 Soulbound Token。
- 仅允许已验证钱包投票。

✅ **步骤 6 — 测试：**

- 在 Hardhat 上测试：
  - 有 Token 的钱包 → 可投票。
  - 无 Token 的钱包 → 无法投票。

- 尝试转移 Token 应失败。

---

选举纲领语义搜索引擎

## 🎯 **动机**

任何公民都可成为候选人，这有利于民主参与。但也可能导致**候选人数激增**，使选民难以做出明智选择。

解决方案是构建一个**智能搜索引擎**，让选民用自然语言描述他们希望看到的政策或价值观，系统返回与之**最匹配的10位候选人**。

这将促进理性投票，减少政治“信息过载”。

## 💡 **方案**

- 每位候选人可上传完整的**选举纲领**至后端。
- 后端存储：
  - 文本全文（例如存数据库）。
  - 区块链上的**纲领哈希**，确保不可篡改与透明性。

- 使用本地 **SBERT** 生成嵌入向量并索引至 **Elasticsearch**。
- 选民输入自然语言查询。
- Elasticsearch 返回语义最相似的10份纲领。
- 可选：通过 REST API 或前端暴露此功能。

## ⚙️ **执行步骤**

✅ **步骤 1 — 搭建本地环境**

- 安装 Elasticsearch OSS 或 OpenSearch。
- 下载 SBERT 模型（如 `all-MiniLM-L6-v2`）。

✅ **步骤 2 — 索引纲领文本**

- 用 Node.js 或 Python 脚本：
  - 读取每份纲领。
  - 用 SBERT 生成嵌入。
  - 将文本与向量存入 Elasticsearch。

✅ **步骤 3 — 创建搜索接口**

- 搭建 REST 或 GraphQL 接口：
  - 接收用户查询。
  - 使用 SBERT 生成查询嵌入。
  - 向 Elasticsearch 查询相似向量。
  - 返回最相关的10位候选人。

✅ **步骤 4 — 区块链集成**

- 将纲领全文的哈希存入区块链（如 DemocracyChain 合约的 mapping）。
- 用户可验证展示文本是否与链上记录一致。

✅ **步骤 5 — 前端（可选）**

- 构建简单搜索页面。
- 显示最匹配候选人及其纲要摘要。

✅ **步骤 6 — 安全与隐私**

- 确保：
  - 个人数据受到保护。
  - 若存储候选人数据，符合 GDPR 要求。

✅ **步骤 7 — 测试与质量指标**

- 测试：
  - 嵌入效果。
  - 查询延迟。
  - 结果准确性。

- 指标包括：
  - Precision\@10
  - Recall
  - 平均倒数排名（MRR）

## 🔗 **技术栈建议**

- **向量数据库：** Elasticsearch OSS / OpenSearch
- **嵌入生成：** SBERT（本地，Hugging Face）
- **后端语言：** Node.js、Python 或两者结合
- **区块链：** Solidity + DemocracyChain
- **前端：**（可选）React、Vue、Svelte 等

## 🚀 **优势**

- 支持 **离线使用**，且完全免费（SBERT 本地 + OSS 栈）。
- 高精度语义搜索。
- 区块链确保文本不可篡改。
- 可扩展至数十万份纲领与数百万查询。
