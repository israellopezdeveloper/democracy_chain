# ğŸ“ ROADMAP - æ°‘ä¸»é“¾RAGç³»ç»Ÿ

## ğŸ§  RAG çš„æœ€ç»ˆç›®æ ‡

**è¾“å…¥ï¼š** é€‰æ°‘ç”¨è‡ªç„¶è¯­è¨€è¡¨è¾¾çš„åå¥½ **è¾“å‡ºï¼š**
ä¸è¯¥åå¥½æœ€åŒ¹é…çš„ 10 ä»½ç«é€‰çº²é¢†

## ğŸ—ºï¸ å®ç° RAG çš„è¯¦ç»†è·¯çº¿å›¾

### ğŸ”¹ é˜¶æ®µ 1ï¼šæ‰¹é‡æ–‡æ¡£æ‘„å–

| æ­¥éª¤    | æè¿°                                                                             | å·¥å…·                                                                                |
| ------- | -------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- |
| **1.1** | æ ‡å‡†åŒ–è¾“å…¥æ ¼å¼ï¼ˆPDFã€Wordã€txt ç­‰ï¼‰                                              | `unstructured`ã€`pdfminer`ã€`docx`                                                  |
| **1.2** | å°†æ–‡æœ¬åˆ†å—ï¼ˆå¸¦å…ƒæ•°æ®çš„æ™ºèƒ½åˆ‡ç‰‡ï¼‰                                                 | `langchain.text_splitter.RecursiveCharacterTextSplitter` æˆ– `unstructured.chunking` |
| **1.3** | ä½¿ç”¨å…ƒæ•°æ®ä¿å­˜æ–‡æ¡£ï¼ˆä¾‹å¦‚ `candidato`ã€`partido`ã€`aÃ±o` ç­‰ï¼‰                      | ä½¿ç”¨å¸¦ç»“æ„åŒ– payload çš„ Qdrantï¼ˆå¦‚ `source_id`ã€`title`ã€`page`ã€`party` ç­‰ï¼‰       |
| **1.4** | å®ç°æ–‡æ¡£å¤„ç† workerï¼ˆç›‘å¬ RabbitMQ/Kafkaï¼Œå¹¶æ‰§è¡Œ parse â†’ chunk â†’ embed â†’ indexï¼‰ | RabbitMQï¼ˆè½»é‡ï¼ŒåŸºç¡€è®¾æ–½ä¸­å·²æœ‰ï¼‰ã€Qdrantã€FastAPI Worker                            |

ğŸ“ **ç»“æœ**ï¼šæ‰€æœ‰ç¨‹åºè¢«å¤„ç†ã€åµŒå…¥å¹¶å¸¦å…ƒæ•°æ®åœ°å­˜å‚¨åœ¨ Qdrant ä¸­ã€‚

### ğŸ”¹ é˜¶æ®µ 2ï¼šç”Ÿæˆä¸æ£€ç´¢åµŒå…¥å‘é‡

| æ­¥éª¤    | æè¿°                                                                           | å·¥å…·                                                                                             |
| ------- | ------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------ |
| **2.1** | é€‰æ‹©æœ¬åœ°åµŒå…¥æ¨¡å‹ï¼ˆè½»é‡ã€ç²¾ç¡®ã€æ”¯æŒå¤šè¯­è¨€ï¼‰                                     | `BAAI/bge-small-en-v1.5` æˆ– `intfloat/multilingual-e5-small` ä¸ `sentence-transformers` æ­é…ä½¿ç”¨ |
| **2.2** | æä¾› API `/search?q=...`ï¼š1ï¸âƒ£ ç”ŸæˆæŸ¥è¯¢åµŒå…¥ï¼Œ2ï¸âƒ£ æŸ¥è¯¢ Qdrantï¼Œ3ï¸âƒ£ è¿”å›æ–‡æœ¬ä¸å…ƒæ•°æ® | FastAPI + `qdrant-client`                                                                        |
| **2.3** | æ·»åŠ å¯é€‰æœç´¢è¿‡æ»¤å™¨ï¼ˆå¦‚ `partido`ã€`aÃ±o`ã€`candidato` ç­‰ï¼‰                      | Qdrant æ”¯æŒ payload ä¸Šçš„å¸ƒå°”è¿‡æ»¤                                                                 |
| **2.4** | æœ€ç»ˆæ’åºï¼šå¯é€‰ä½¿ç”¨ `bge-reranker` è¿›è¡Œè¯­ä¹‰é‡æ’åºæˆ–ç»“åˆæ—¶é—´æƒé‡                 | `bge-reranker-base`ï¼ˆå¦‚éœ€æœ¬åœ°è¯­ä¹‰ rerankingï¼‰                                                    |

ğŸ“ **ç»“æœ**ï¼šä¸€ä¸ªå¼ºå¤§ã€ç²¾å‡†ã€å¯å®šåˆ¶çš„è¯­ä¹‰æœç´¢ç«¯ç‚¹ã€‚

### ğŸ”¹ é˜¶æ®µ 3ï¼šå‰ç«¯ï¼ˆæœç´¢ + ç»“æœå±•ç¤ºï¼‰

| æ­¥éª¤    | æè¿°                                 | å·¥å…·                                                         |
| ------- | ------------------------------------ | ------------------------------------------------------------ |
| **3.1** | å®ç°å¸¦å€™é€‰äºº/æ”¿å…šè¿‡æ»¤å™¨çš„æœç´¢è¡¨å•    | React + Tailwind + Zustandï¼ˆè‹¥ä½¿ç”¨å…¨å±€çŠ¶æ€ç®¡ç†ï¼‰             |
| **3.2** | ç»“æœå±•ç¤ºï¼šçªå‡ºå…³é”®è¯ç‰‡æ®µå¹¶æ˜¾ç¤ºå…ƒæ•°æ® | ä½¿ç”¨ `<mark>` é«˜äº®åŒ¹é…è¯ï¼Œå¦‚ `...æ–‡æœ¬<mark>å…³é”®è¯</mark>...` |
| **3.3** | æ·»åŠ åˆ†é¡µæˆ–æ— é™æ»šåŠ¨ï¼ˆè‹¥ç»“æœè¾ƒå¤šï¼‰     | `react-infinite-scroll-component`                            |

ğŸ“ **ç»“æœ**ï¼šä¸€ä¸ªç°ä»£ã€æ¸…æ™°çš„ç”¨æˆ·ç•Œé¢ä¾›é€‰æ°‘æœç´¢ä½¿ç”¨ã€‚

### ğŸ”¹ é˜¶æ®µ 4ï¼šå¯æ‰©å±•æ€§ä¸é²æ£’æ€§

| æ­¥éª¤    | æè¿°                                                                  | å·¥å…·                                                      |
| ------- | --------------------------------------------------------------------- | --------------------------------------------------------- |
| **4.1** | å¤š worker å¹¶è¡Œç´¢å¼•ï¼ˆä½¿ç”¨ RabbitMQ é˜Ÿåˆ— + ç¡®è®¤/é‡è¯•æœºåˆ¶ï¼‰              | RabbitMQ durable queues                                   |
| **4.2** | ä½¿ç”¨ Redis ç¼“å­˜å¸¸è§æŸ¥è¯¢ï¼ˆä¾‹å¦‚æœç´¢å­—ç¬¦ä¸² â†’ top10 idï¼Œè®¾ç½® 6 å°æ—¶è¿‡æœŸï¼‰ | Redis                                                     |
| **4.3** | Qdrant åˆ†ç‰‡ï¼ˆæŒ‰åœ°åŒºã€é€‰ä¸¾ç±»å‹ç­‰ï¼‰æˆ–å¤šå®ä¾‹éƒ¨ç½²                         | Qdrant é›†ç¾¤æ¨¡å¼ï¼ˆv1.7+ï¼‰æˆ–åè°ƒå¤šä¸ªå®ä¾‹                    |
| **4.4** | æ—¥å¿—ã€æŒ‡æ ‡ã€é”™è¯¯ â†’ Prometheus + Grafana                               | `prometheus_fastapi_instrumentator` + Docker åŒ–çš„ Grafana |

ğŸ“ **ç»“æœ**ï¼šä¸€ä¸ªå¯æ¨ªå‘æ‰©å±•ã€å…·å¤‡é”™è¯¯å¤„ç†æœºåˆ¶çš„å¥å£®ç³»ç»Ÿã€‚

### ğŸ”¹ é˜¶æ®µ 5ï¼šè¯„ä¼°ä¸åé¦ˆ

| æ­¥éª¤    | æè¿°                                              | å·¥å…·                                                  |
| ------- | ------------------------------------------------- | ----------------------------------------------------- |
| **5.1** | åˆ›å»ºæµ‹è¯•æ•°æ®é›†ï¼šæ¨¡æ‹Ÿé€‰æ°‘æŸ¥è¯¢ + é¢„æœŸç›¸å…³ç¨‹åº       | CSVï¼šåŒ…å« `query,texto_relevante_expected`            |
| **5.2** | è¡¡é‡ top-k ç²¾åº¦ï¼ˆä¾‹å¦‚ï¼šç›®æ ‡ç¨‹åºæ˜¯å¦å‡ºç°åœ¨ top10ï¼‰ | ä½¿ç”¨ recall/precision/accuracy æŒ‡æ ‡çš„éªŒè¯è„šæœ¬         |
| **5.3** | æ”¶é›†ç”¨æˆ·åé¦ˆï¼šå¯¹ç»“æœæ·»åŠ  ğŸ‘ğŸ‘ æŒ‰é’®å¹¶è®°å½•åé¦ˆ      | PostgreSQL è®°å½• `query`ã€`result_id`ã€`feedback=1/-1` |

ğŸ“ **ç»“æœ**ï¼šç³»ç»Ÿå…·å¤‡è¯„ä¼°æœºåˆ¶ï¼Œå¯åŸºäºåé¦ˆä¸æ–­ä¼˜åŒ–ã€‚

## ğŸ§° æœ¬åœ° + å…è´¹çš„åŸºç¡€éœ€æ±‚

- ğŸ” **Qdrant** æœ¬åœ°éƒ¨ç½²ï¼ˆDocker æ¨¡å¼ï¼‰â†’ æ”¯æŒé«˜çº§è¿‡æ»¤çš„å‘é‡å­˜å‚¨
- ğŸ§ 
  **æœ¬åœ°åµŒå…¥æ¨¡å‹**ï¼ˆå¦‚ BGE-smallã€E5-smallï¼‰â†’ å†…å­˜çº¦ 300â€“400MBï¼ŒCPU å³å¯è¿è¡Œ
- ğŸ‡ **RabbitMQ** â†’ å·²åœ¨ `docker-compose.yml` ä¸­é…ç½®
- ğŸ **FastAPI** â†’ ç”¨äºæœç´¢ä¸æ‘„å–çš„ REST API
- ğŸ³ **Docker Compose** â†’ ä¸€é”®éƒ¨ç½²æ‰€æœ‰ç»„ä»¶

## ğŸš€ æ¨èçš„ä¸‹ä¸€æ­¥ï¼Ÿ

> å®ç°ä¸€ä¸ª**ç‹¬ç«‹è„šæœ¬** `processor.py`ï¼š
>
> 1. éå† `./programs/*.pdf`
> 2. æŒ‰é¡µæå–æ–‡æœ¬
> 3. æ‹†åˆ†ä¸ºå¸¦å…ƒæ•°æ®çš„ chunks
> 4. ç”ŸæˆåµŒå…¥å‘é‡
> 5. æ’å…¥ Qdrant
>
> è¿™å°†æ„å»ºç³»ç»Ÿçš„æ ¸å¿ƒåŸºç¡€ï¼Œè€Œæ— éœ€ç«‹å³é›†æˆå®Œæ•´åç«¯ã€‚
